import{Y as e}from"./vendor.19c9fb29.js";import{e as t}from"./events.b35c4505.js";var s={},a={},r={};Object.defineProperty(r,"__esModule",{value:!0}),r.getLowerCase=void 0,r.getLowerCase=function(e){return e?e.toLowerCase():e},Object.defineProperty(a,"__esModule",{value:!0}),a.SafeAppProvider=void 0;const n=t.exports,i=r,o={MAINNET:1,RINKEBY:4,XDAI:100};a.SafeAppProvider=class{constructor(e,t){this.submittedTxs=new Map,this.events=new n.EventEmitter,this.safe=e,this.sdk=t}async connect(){this.events.emit("connect",{chainId:this.chainId})}async disconnect(){}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}get chainId(){return o[this.safe.network]}async request(e){const{method:t,params:s=[]}=e;switch(t){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return`0x${this.chainId.toString(16)}`;case"eth_sendTransaction":const t=Object.assign({value:"0",data:"0x"},s[0]),r=await this.sdk.txs.send({txs:[t]});return this.submittedTxs.set(r.safeTxHash,{from:this.safe.safeAddress,hash:r.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:t.data,value:t.value,to:t.to,blockHash:null,blockNumber:null,transactionIndex:null}),r.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([i.getLowerCase(s[0]),s[1]]);case"eth_getCode":return this.sdk.eth.getCode([i.getLowerCase(s[0]),s[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([i.getLowerCase(s[0]),s[1],s[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([s[0],s[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([s[0],s[1]]);case"eth_getTransactionByHash":let n=s[0];try{n=(await this.sdk.txs.getBySafeTxHash(n)).transactionHash||n}catch(a){}return this.submittedTxs.has(n)?this.submittedTxs.get(n):this.sdk.eth.getTransactionByHash([n]).then((e=>(e&&(e.hash=s[0]),e)));case"eth_getTransactionReceipt":{let e=s[0];try{e=(await this.sdk.txs.getBySafeTxHash(e)).transactionHash||e}catch(a){}return this.sdk.eth.getTransactionReceipt([e]).then((e=>(e&&(e.transactionHash=s[0]),e)))}case"eth_estimateGas":return 0;case"eth_call":return this.sdk.eth.call([s[0],s[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([s[0]]);default:throw Error(`"${e.method}" not implemented`)}}},function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SafeAppProvider=void 0;var t=a;Object.defineProperty(e,"SafeAppProvider",{enumerable:!0,get:function(){return t.SafeAppProvider}})}(s);var h=e(s),c=Object.freeze(Object.assign(Object.create(null),s,{[Symbol.toStringTag]:"Module",default:h}));export{c as i};
